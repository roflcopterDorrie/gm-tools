(this["webpackJsonpgm-tools"]=this["webpackJsonpgm-tools"]||[]).push([[0],{101:function(e,a,t){},104:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(17),o=t.n(s),c=t(1),l=t(2),i=t(8),p=t(4),d=t(3),u=t(30),m=t(31),h=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(){var e;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=a.call.apply(a,[this].concat(s))).updateData=function(a,t,n){e.props.updateData(e.props.data.id,e.componentName,t,n)},e.toolbar=function(a){var t=[];for(var n in a=a||["add-location","add-character","add-encounter","delete"])"add-location"===a[n]?t.push(r.a.createElement("button",{onClick:function(){return e.props.newCard("Location",e.props.data.id,e.componentName)}},r.a.createElement("i",{className:"fas fa-globe-americas"}))):"add-character"===a[n]?t.push(r.a.createElement("button",{onClick:function(){return e.props.newCard("Character",e.props.data.id,e.componentName)}},r.a.createElement("i",{className:"fas fa-user-alt"}))):"add-encounter"===a[n]?t.push(r.a.createElement("button",{onClick:function(){return e.props.newCard("Encounter",e.props.data.id,e.componentName)}},r.a.createElement("i",{className:"fas fa-skull-crossbones"}))):"delete"===a[n]?t.push(r.a.createElement("button",{onClick:function(){return e.props.deleteCard(e.componentName,e.props.data.id)}},r.a.createElement("i",{className:"fas fa-trash-alt"}))):"encounter-map"===a[n]?e.props.data.map&&t.push(r.a.createElement("button",{onClick:function(){return window.open("/encounter-map/"+e.props.data.id)}},r.a.createElement("i",{className:"fas fa-map"}))):"encounter-tracker"===a[n]?t.push(r.a.createElement("button",{onClick:function(){return window.open("/encounter-tracker/"+e.props.data.id)}},r.a.createElement("i",{className:"fas fa-skull-crossbones"}))):"add-player-stat"===a[n]&&t.push(r.a.createElement("button",{onClick:function(a){return e.props.addData("PlayerStat")}},r.a.createElement("i",{className:"fas fa-plus"})));return t},e}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("section",null)}}]),t}(r.a.PureComponent),f=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(){var e;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).onBlur=function(a){e.props.onBlur(e.props.hasOwnProperty("id")?e.props.id:null,e.props.name,a.target.innerText.trim())},e}return Object(l.a)(t,[{key:"render",value:function(){var e="".concat(this.props.tag);return r.a.createElement(e,{contentEditable:!0,suppressContentEditableWarning:!0,onBlur:this.onBlur,placeholder:this.props.placeholder,className:this.props.className?this.props.className.join(" "):""},this.props.content||"")}}]),t}(r.a.Component),g=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.locations.reduce((function(a,t,n){return t.parentId===e.props.parentId&&a.push(r.a.createElement("li",{key:n},r.a.createElement("span",{className:"card-minor-minor"},t.type),r.a.createElement("i",{className:"fas fa-globe-americas"}),"\xa0",r.a.createElement("button",{className:"link",onClick:function(){return e.props.showCard("Location",t.id)}},t.name))),a}),[]);return a.length?r.a.createElement("div",null,r.a.createElement("h3",null,"Locations"),r.a.createElement("ul",{className:"link-list"},a)):""}}]),t}(r.a.PureComponent),E=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.characters.reduce((function(a,t,n){return t.parentId===e.props.parentId&&t.parentType===e.props.parentType&&a.push(r.a.createElement("li",{key:n},r.a.createElement("span",{className:"card-minor-minor"},t.role),r.a.createElement("i",{className:"fas fa-user-alt"}),"\xa0",r.a.createElement("button",{className:"link",onClick:function(){return e.props.showCard("Character",t.id)}},t.name))),a}),[]);return a.length?r.a.createElement("div",null,r.a.createElement("h3",null,"Characters"),r.a.createElement("ul",{className:"link-list"},a)):""}}]),t}(r.a.PureComponent),v=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).changeMap=function(){n.setState({mapInput:!n.state.mapInput})},n.componentName="Location",n.state={mapInput:!1},n}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.getData("Location",this.props.data.parentId),t="";a&&(t=r.a.createElement("span",{class:"card-minor",style:{float:"right"}},r.a.createElement("i",{className:"fas fa-globe-americas"}),"\xa0",r.a.createElement("button",{className:"link",onClick:function(){return e.props.showCard("Location",a.id)}},a.name)));var n=this.props.data.map?r.a.createElement("button",{className:"link",onClick:function(a){return e.props.open("image","Location",e.props.data.id,"map")}},r.a.createElement("img",{src:this.props.data.map,className:"map-preview"})):"";return r.a.createElement("section",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card__type"},r.a.createElement("i",{className:"fas fa-globe-americas"})," Location")),r.a.createElement("div",{className:"card-body"},r.a.createElement(f,{tag:"span",onBlur:this.updateData,name:"type",content:this.props.data.type||"",placeholder:"Type",className:["card-minor"]}),t,r.a.createElement(f,{tag:"h2",onBlur:this.updateData,name:"name",content:this.props.data.name||"",placeholder:"Name",className:["card-title"]}),n,r.a.createElement("div",null,r.a.createElement("button",{className:"link",onClick:this.changeMap},r.a.createElement("i",{className:"fas fa-map"})," Map"),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"map",content:this.props.data.map||"",placeholder:"Image URL",className:["single-line",this.state.mapInput?"":"hidden"]})),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"description",content:this.props.data.description||"",placeholder:"Description"}),r.a.createElement(g,{locations:this.props.allData.locations,showCard:this.props.showCard,parentId:this.props.data.id,parentType:"Location"}),r.a.createElement(E,{characters:this.props.allData.characters,showCard:this.props.showCard,parentId:this.props.data.id,parentType:"Location"})),r.a.createElement("div",{className:"card-footer"},this.toolbar()))}}]),t}(h),y=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(){var e;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).updateData=function(a,t,n){console.log(a+t+n),e.props.updateData(a,"Interaction",t,n)},e.addInteraction=function(){e.props.addData("Interaction",e.props.parentId,e.props.parentType)},e}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.allData.interactions.reduce((function(a,t,n){return t.parentId===e.props.parentId&&a.push(r.a.createElement(f,{tag:"p",onBlur:e.updateData,name:"name",content:t.name||"",placeholder:"name",id:t.id})),a}),[]);return r.a.createElement("div",null,r.a.createElement("h3",null,"Interactions",r.a.createElement("button",{className:"link",onClick:this.addInteraction},r.a.createElement("i",{className:"fas fa-user-plus"}))),a)}}]),t}(r.a.PureComponent),b=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).componentName="Character",n}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.getData("Location",this.props.data.parentId),t="";return a&&(t=r.a.createElement("span",{class:"card-minor",style:{float:"right"}},r.a.createElement("i",{className:"fas fa-globe-americas"}),"\xa0",r.a.createElement("button",{className:"link",onClick:function(){return e.props.showCard("Location",a.id)}},a.name))),r.a.createElement("section",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card__type"},r.a.createElement("i",{className:"fas fa-user-alt"})," Character")),r.a.createElement("div",{className:"card-body"},r.a.createElement(f,{tag:"span",onBlur:this.updateData,name:"role",content:this.props.data.role||"",placeholder:"Job/role",className:["card-minor"]}),t,r.a.createElement(f,{tag:"h2",onBlur:this.updateData,name:"name",content:this.props.data.name||"",placeholder:"Name",className:["card-title"]}),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"description",content:this.props.data.description||"",placeholder:"Description"}),r.a.createElement("h3",null,"Motivations"),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"motivations",content:this.props.data.motivations||"",placeholder:"none"}),r.a.createElement("h3",null,"Weaknesses"),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"weaknesses",content:this.props.data.weaknesses||"",placeholder:"none"}),r.a.createElement(y,{parentId:this.props.data.id,parentType:this.componentName,updateData:this.props.updateData,addData:this.props.addData,allData:this.props.allData})),r.a.createElement("div",{className:"card-footer"},this.toolbar(["delete"])))}}]),t}(h),D=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).componentName="Quest",n}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("section",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card__type"},r.a.createElement("i",{className:"fas fa-scroll"})," Quest")),r.a.createElement("div",{className:"card-body"},r.a.createElement(f,{tag:"h2",onBlur:this.updateData,name:"name",content:this.props.data.name||"",placeholder:"Name",className:["card-title"]}),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"description",content:this.props.data.description||"",placeholder:"Description"})),r.a.createElement("div",{className:"card-footer"},this.toolbar()))}}]),t}(h),N=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).getMonsterList=function(e,a,t){return r.a.createElement("div",null,r.a.createElement("select",{onChange:function(e){n.updateData(a,e.target.value)},value:e},n.props.monsterList.map((function(e){return r.a.createElement("option",{value:e.id},e.name)})))," x\xa0",r.a.createElement("input",{type:"number",value:t,onChange:function(e){n.updateData(a,null,e.target.value)}}),"\xa0",r.a.createElement("button",{className:"link",onClick:function(e){n.deleteMonster(a)}},r.a.createElement("i",{className:"fas fa-times"})))},n.updateData=function(e,a,t){var r=n.state.selectedMonsters.map((function(n,r){return e===r?{id:a||n.id,count:t||n.count}:n}));n.setState({selectedMonsters:r}),n.props.updateData(n.props.parentId,"Encounter","monsters",r)},n.addMonster=function(){var e=n.state.selectedMonsters.concat({id:1,count:1});n.setState({selectedMonsters:e}),n.props.updateData(n.props.parentId,"Encounter","monsters",e)},n.deleteMonster=function(e){var a=n.state.selectedMonsters.reduce((function(a,t,n){return n!==e&&a.push(t),a}),[]);n.setState({selectedMonsters:a}),n.props.updateData(n.props.parentId,"Encounter","monsters",a)},n.state={selectedMonsters:n.props.selectedMonsters||[]},n.updateData=n.updateData.bind(Object(i.a)(n)),n}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.selectedMonsters?this.props.selectedMonsters.map((function(a,t){return e.getMonsterList(a.id,t,a.count)})):[];return r.a.createElement("div",null,r.a.createElement("h3",null,"Monsters",r.a.createElement("button",{className:"link",onClick:this.addMonster},r.a.createElement("i",{className:"fas fa-spider"}))),a)}}]),t}(r.a.PureComponent),O=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).changeMap=function(){n.setState({mapInput:!n.state.mapInput})},n.componentName="Encounter",n.state={mapInput:!1},n}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.data.map?r.a.createElement("button",{className:"link",onClick:function(a){return e.props.open("image","Encounter",e.props.data.id,"map")}},r.a.createElement("img",{src:this.props.data.map,className:"map-preview"})):"";return r.a.createElement("section",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card__type"},r.a.createElement("i",{className:"fas fa-skull-crossbones"})," Encounter")),r.a.createElement("div",{className:"card-body"},r.a.createElement(f,{tag:"h2",onBlur:this.updateData,name:"name",content:this.props.data.name||"",placeholder:"Name",className:["card-title"]}),a,r.a.createElement("div",null,r.a.createElement("button",{className:"link",onClick:this.changeMap},r.a.createElement("i",{className:"fas fa-map"})," Map"),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"map",content:this.props.data.map||"",placeholder:"Image URL",className:["single-line",this.state.mapInput?"":"hidden"]})),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"description",content:this.props.data.description||"",placeholder:"Description"}),r.a.createElement(N,{parentId:this.props.data.id,parentType:this.componentName,updateData:this.props.updateData,addData:this.props.addData,allData:this.props.allData,selectedMonsters:this.props.data.monsters,monsterList:this.props.staticData.monsters}),r.a.createElement("h3",null,"Tactics"),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"tactics",content:this.props.data.tactics||"",placeholder:"none"}),r.a.createElement("h3",null,"Environmental"),r.a.createElement(f,{tag:"p",onBlur:this.updateData,name:"environmental",content:this.props.data.environmental||"",placeholder:"none"})),r.a.createElement("div",{className:"card-footer"},this.toolbar(["encounter-map","encounter-tracker","delete"])))}}]),t}(h),C=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).search=function(e){n.setState({search:e.target.value})},n.componentName="Search",n.state={search:""},n}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=[],t=this.props.getDataStoreTypes(),n=function(n){"Interaction"!==t[n].component&&a.push(e.props.allData[t[n].store].reduce((function(a,s,o){return s.name.toLowerCase().includes(e.state.search.toLowerCase())&&a.push(r.a.createElement("li",{key:o},r.a.createElement("span",{className:"fa-li"},r.a.createElement("i",{className:[t[n].icon,"fa"].join(" ")})),r.a.createElement("span",{className:"card-minor-minor"},s.type||s.role),r.a.createElement("button",{className:"link",onClick:function(){return e.props.showCard(t[n].component,s.id)}},s.name))),a}),[]))};for(var s in t)n(s);return r.a.createElement("section",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card__type"},r.a.createElement("i",{className:"fas fa-search"})," ")),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"search-box"},r.a.createElement("input",{type:"text",onChange:this.search,placeholder:"Search"})),r.a.createElement("ul",{className:"fa-ul search-results"},a)))}}]),t}(h),k=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(){var e;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).updateData=function(a,t,n){e.props.updateData(e.props.data.id,"PlayerStat",t,n)},e}return Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(f,{tag:"span",name:"name",content:this.props.data.name||"",placeholder:"Name",onBlur:this.updateData})),r.a.createElement("td",null,r.a.createElement(f,{tag:"span",name:"class",content:this.props.data.class||"",placeholder:"Class",onBlur:this.updateData})),r.a.createElement("td",null,r.a.createElement(f,{tag:"span",name:"pp",content:this.props.data.pp||"",placeholder:"PP",onBlur:this.updateData})),r.a.createElement("td",null,r.a.createElement(f,{tag:"span",name:"ac",content:this.props.data.ac||"",placeholder:"AC",onBlur:this.updateData})),r.a.createElement("td",null,r.a.createElement(f,{tag:"span",name:"proficiencies",content:this.props.data.proficiencies||"",placeholder:"Proficiencies",onBlur:this.updateData})),r.a.createElement("td",null,r.a.createElement(f,{tag:"span",name:"languages",content:this.props.data.languages||"",placeholder:"Languages",onBlur:this.updateData})),r.a.createElement("td",null,r.a.createElement("button",{className:"link",onClick:function(a){e.props.deleteData("PlayerStat",e.props.data.id)}},r.a.createElement("i",{className:"fas fa-times"}))))}}]),t}(r.a.PureComponent),w=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).componentName="PlayerStats",n}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.allData.playerStats.map((function(a,t){return r.a.createElement(k,{data:a,updateData:e.props.updateData,deleteData:e.props.deleteData})}));return r.a.createElement("section",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card__type"},r.a.createElement("i",{className:"fas fa-user-alt"})," Player stats")),r.a.createElement("div",{className:"card-body"},r.a.createElement("table",{className:"playerStats"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Class"),r.a.createElement("th",null,"PP"),r.a.createElement("th",null,"AC"),r.a.createElement("th",null,"Proficiencies"),r.a.createElement("th",null,"Languages"),r.a.createElement("th",null))),r.a.createElement("tbody",null,a))),r.a.createElement("div",{className:"card-footer"},this.toolbar(["add-player-stat"])))}}]),t}(h),j=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"toolbar"},r.a.createElement("button",{onClick:function(){return e.props.showCard("Search")}},r.a.createElement("i",{className:"fas fa-fw fa-search"})),r.a.createElement("button",{onClick:function(){return e.props.newCard("Location",null)}},r.a.createElement("i",{className:"fas fa-fw fa-globe-americas"})),r.a.createElement("button",{onClick:function(){return e.props.newCard("Character",null)}},r.a.createElement("i",{className:"fas fa-fw fa-user-alt"})),r.a.createElement("button",{onClick:function(){return e.props.newCard("Quest",null)}},r.a.createElement("i",{className:"fas fa-fw fa-scroll"})),r.a.createElement("button",{onClick:function(){return e.props.newCard("Encounter",null)}},r.a.createElement("i",{className:"fas fa-fw fa-skull-crossbones"})),r.a.createElement("button",{onClick:function(){return e.props.showCard("PlayerStats",null)}},r.a.createElement("i",{className:"fas fa-fw fa-users"})))}}]),t}(r.a.PureComponent),S=t(19),I=t.n(S),B=(t(93),t(94),Object(m.WidthProvider)(m.Responsive)),L={Location:v,Character:b,Quest:D,Encounter:O},T={Search:C,PlayerStats:w},M=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;Object(c.a)(this,t),(n=a.call(this,e)).createCard=function(e){var a=L[e.component.type];if(void 0!==a){var t=n.props.getData(e.component.type,e.component.id),s=n.props.getAllData(),o=n.props.getStaticData();return r.a.createElement("div",{key:e.grid.i,"data-grid":e.grid},r.a.createElement(a,{data:t,allData:s,staticData:o,showCard:n.showCard,newCard:n.newCard,deleteCard:n.deleteCard,updateData:n.props.updateData,getAllDataByType:n.props.getAllDataByType,getData:n.props.getData,addData:n.props.addData,open:n.props.open}),r.a.createElement("span",{className:"card-close",onClick:function(a){return n.closeCard(e.grid.i)}},r.a.createElement("i",{className:"fas fa-times"})))}if(void 0!==(a=T[e.component.type])){var c=n.props.getAllData();return r.a.createElement("div",{key:e.grid.i,"data-grid":e.grid},r.a.createElement(a,{allData:c,showCard:n.showCard,getData:n.props.getData,getDataStoreTypes:n.props.getDataStoreTypes,updateData:n.props.updateData,deleteData:n.props.deleteData,addData:n.props.addData}),r.a.createElement("span",{className:"card-close",onClick:function(a){return n.closeCard(e.grid.i)}},r.a.createElement("i",{className:"fas fa-times"})))}},n.showCard=function(e,a){var t=L[e];void 0===t?void 0===(t=T[e])||n.setState({layout:{layout:n.state.layout.layout.concat({grid:{i:"n"+n.state.layout.keyCounter,x:0,y:0,w:2,h:4},component:{type:e}}),keyCounter:n.state.layout.keyCounter+1}}):n.setState({layout:{layout:n.state.layout.layout.concat({grid:{i:"n"+n.state.layout.keyCounter,x:0,y:0,w:2,h:4},component:{id:a,type:e}}),keyCounter:n.state.layout.keyCounter+1}})},n.newCard=function(e,a,t){n.showCard(e,n.props.addData(e,a,t))},n.deleteCard=function(e,a){var t=JSON.parse(JSON.stringify(n.state));t.layout.layout=I.a.reject(t.layout.layout,(function(e){return e.component.id===a})),n.setState(t),n.props.deleteData(e,a)},n.closeCard=function(e){var a=JSON.parse(JSON.stringify(n.state));a.layout.layout=I.a.reject(a.layout.layout,(function(a){return a.grid.i===e})),n.setState(a)},n.onLayoutChange=function(e){var a=JSON.parse(JSON.stringify(n.state));for(var t in e)a.layout.layout[t].grid=Object(u.a)(Object(u.a)({},a.layout.layout[t].grid),e[t]);n.setState(a),localStorage.setItem("gm-tools-layout",JSON.stringify(a.layout))};var s=JSON.parse(localStorage.getItem("gm-tools-layout"))||{layout:[{grid:{i:"n1",x:0,y:0,w:6,h:3},component:{id:"1",type:"Location"}}],keyCounter:2};return n.state={layout:s},n}return Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"frame"},r.a.createElement("div",{className:"grid"},r.a.createElement(B,Object.assign({},this.props,{onLayoutChange:this.onLayoutChange}),I.a.map(this.state.layout.layout,(function(a){return e.createCard(a)})))),r.a.createElement(j,{newCard:this.newCard,showCard:this.showCard}))}}],[{key:"defaultProps",get:function(){return{className:"layout",cols:{lg:8,md:10,sm:6,xs:4,xxs:2},rowHeight:100,draggableHandle:".card-header"}}}]),t}(r.a.Component),J=t(12),A=t(20),x=!1,P=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;Object(c.a)(this,t),(n=a.call(this,e)).resetGrid=function(){var e=parseInt(document.getElementById("mapWidth").value),a=parseInt(document.getElementById("gridSize").value),t=JSON.parse(JSON.stringify(n.state));t.data.grid.mapWidth=e,t.data.grid.gridSize=a,t.data.grid.fog=[],t.data.grid.clearFog=!1,n.setState(t),n.drawGrid(t.data.grid)},n.drawGrid=function(e){var a=e.gridSize,t=Math.ceil(e.mapHeight/a),n=Math.ceil(e.mapWidth/a),r=e.fog,s=e.clearFog;A.a("#encounter-grid__svg").selectAll("*").remove(),A.a("#encounter-grid__svg").attr("width",n*a+"px").attr("height",t*a+"px").selectAll(".row").data((function(){for(var e=[],o=1,c=1,l=a,i=a,p=0;p<t;p++){e.push([]);for(var d=0;d<n;d++){var u=!0;if(!s){u=!1;var m,h=Object(J.a)(r);try{for(h.s();!(m=h.n()).done;){var f=m.value;if(parseInt(f.row)===p&&parseInt(f.col)===d){u=!0;break}}}catch(g){h.e(g)}finally{h.f()}}e[p].push({x:o,y:c,width:l,height:i,row:p,col:d,reveal:u}),o+=l}o=1,c+=i}return e})).enter().append("g").attr("class","row").selectAll(".square").data((function(e){return e})).enter().append("rect").attr("class",(function(e){return e.reveal?"square reveal":"square"})).attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})).attr("data-reveal",(function(e){return e.reveal})).attr("data-row",(function(e){return e.row})).attr("data-col",(function(e){return e.col})).attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height})).on("mousedown",(function(e){A.a(this).attr("class","square reveal").attr("data-reveal",!0)})).on("mouseover",(function(e){x&&A.a(this).attr("class","square reveal").attr("data-reveal",!0)}))},n.saveFog=function(){var e,a=[],t=document.querySelectorAll(".square[data-reveal=true]"),r=Object(J.a)(t);try{for(r.s();!(e=r.n()).done;){var s=e.value;a.push({row:s.getAttribute("data-row"),col:s.getAttribute("data-col")})}}catch(c){r.e(c)}finally{r.f()}var o=JSON.parse(JSON.stringify(n.state));o.data.grid.fog=a,n.setState(o),n.props.updateData(n.props.id,"Encounter","grid",o.data.grid)},n.toggleFog=function(){var e,a=document.querySelectorAll(".square[data-reveal=false]"),t=Object(J.a)(a);try{for(t.s();!(e=t.n()).done;){var r=e.value;n.revealToggle?r.classList.add("tempReveal"):r.classList.remove("tempReveal")}}catch(s){t.e(s)}finally{t.f()}n.revealToggle=!n.revealToggle},n.clearFog=function(){var e,a=document.querySelectorAll(".square[data-reveal=false]"),t=Object(J.a)(a);try{for(t.s();!(e=t.n()).done;){e.value.classList.add("reveal")}}catch(s){t.e(s)}finally{t.f()}var r=JSON.parse(JSON.stringify(n.state));r.data.grid.fog=[],r.data.grid.clearFog=!0,n.setState(r),n.props.updateData(n.props.id,"Encounter","grid",r.data.grid)},n.hideToolbar=function(){document.getElementById("encounter-grid__controls").setAttribute("style","display: none;")};var r=n.props.getData("Encounter",n.props.id);return r.grid||(r.grid={gridSize:125,mapWidth:2e3,clearFog:!1,fog:[]}),n.state={data:r},n.revealToggle=!0,document.body.classList.add("encounter-map"),n}return Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.getElementById("encounter-grid").addEventListener("mousedown",(function(){return x=!0})),document.addEventListener("mouseup",(function(){x=!1,e.saveFog(e)}));var a=JSON.parse(JSON.stringify(this.state));a.data.grid.mapHeight=document.getElementById("encounter-grid").offsetHeight,this.setState(a),this.drawGrid(a.data.grid)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"encounter-grid__controls",id:"encounter-grid__controls"},r.a.createElement("label",null,"Map size"),r.a.createElement("input",{type:"number",defaultValue:this.state.data.grid.mapWidth,id:"mapWidth"}),"px",r.a.createElement("label",null,"Grid size"),r.a.createElement("input",{type:"number",defaultValue:this.state.data.grid.gridSize,id:"gridSize"}),"px",r.a.createElement("input",{type:"submit",value:"Reset grid",onClick:this.resetGrid}),r.a.createElement("input",{type:"submit",value:"Toggle fog",onClick:this.toggleFog}),r.a.createElement("input",{type:"submit",value:"Clear fog",onClick:this.clearFog}),r.a.createElement("input",{type:"submit",value:"Hide controls",onClick:this.hideToolbar})),r.a.createElement("div",{id:"encounter-grid",className:"encounter-grid"},r.a.createElement("img",{src:this.state.data.map,width:this.state.data.grid.mapWidth+"px"}),r.a.createElement("svg",{id:"encounter-grid__svg"})))}}]),t}(r.a.Component),_=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).state={data:n.props.getData("Encounter",n.props.id)},document.body.classList.add("encounter-tracker"),n}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(r.a.Component),q=t(49),W=t(5),F=t(48);t(96),t(100),t(101);function z(e){var a=Object(W.f)().id;return r.a.createElement(P,{getData:e.getData,updateData:e.updateData,id:a})}function G(e){var a=Object(W.f)().id;return r.a.createElement(_,{getData:e.getData,updateData:e.updateData,id:a})}var H=function(e){Object(p.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).getDataStore=function(e){var a=n.getDataStoreTypes();for(var t in a)if(a[t].component===e)return a[t].store;return null},n.getDataStoreTypes=function(){return[{component:"Location",store:"locations",icon:"fa-globe-americas"},{component:"Character",store:"characters",icon:"fa-user-alt"},{component:"Quest",store:"quests",icon:"fa-scroll"},{component:"Encounter",store:"encounters",icon:"fa-skull-crossbones"},{component:"Interaction",store:"interactions",icon:"fa-people-arrows"},{component:"PlayerStat",store:"playerStats",icon:"fa-users"}]},n.getAllData=function(){return n.state.data},n.getData=function(e,a){a=parseInt(a);var t=n.getDataStore(e);for(var r in n.state.data[t])if(n.state.data[t][r].id===a)return n.state.data[t][r]},n.getStaticData=function(){return{monsters:F}},n.getAllDataByType=function(e){var a=n.getDataStore(e);return n.state.data[a]},n.updateData=function(e,a,t,r){e=parseInt(e);var s=n.getDataStore(a);for(var o in n.state.data[s])if(n.state.data[s][o].id===e){var c=JSON.parse(JSON.stringify(n.state));return c.data[s][o][t]=r,n.setState(c),void localStorage.setItem("gm-tools-data",JSON.stringify(c.data))}},n.deleteData=function(e,a){var t=n.getDataStore(e),r=JSON.parse(JSON.stringify(n.state));r.data[t]=I.a.reject(r.data[t],(function(e){return e.id===a})),n.setState(r),localStorage.setItem("gm-tools-data",JSON.stringify(r.data))},n.addData=function(e,a,t){var r=n.getDataStore(e),s=JSON.parse(JSON.stringify(n.state));return s.data.nextId++,s.data[r].push({id:s.data.nextId,parentId:a||null,parentType:t||null,name:"New "+e}),n.setState(s),localStorage.setItem("gm-tools-data",JSON.stringify(s.data)),s.data.nextId},n.open=function(e,a,t,r){if("image"===e){var s=n.getData(a,t);if(s){var o=window.open("about:blank"),c=new Image;c.src=s[r],c.style="width: 100%",setTimeout((function(){o.document.write(c.outerHTML)}),0)}}},n.state={data:JSON.parse(localStorage.getItem("gm-tools-data"))||{locations:[],characters:[],quests:[],interactions:[],nextId:1}},n.getData=n.getData.bind(Object(i.a)(n)),n.getAllDataByType=n.getAllDataByType.bind(Object(i.a)(n)),n.updateData=n.updateData.bind(Object(i.a)(n)),n.getAllData=n.getAllData.bind(Object(i.a)(n)),n.addData=n.addData.bind(Object(i.a)(n)),n.deleteData=n.deleteData.bind(Object(i.a)(n)),n.open=n.open.bind(Object(i.a)(n)),n.getDataStoreTypes=n.getDataStoreTypes.bind(Object(i.a)(n)),n}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("main",null,r.a.createElement(q.a,null,r.a.createElement(W.c,null,r.a.createElement(W.a,{path:"/encounter-map/:id",children:r.a.createElement(z,{getData:this.getData,updateData:this.updateData})}),r.a.createElement(W.a,{path:"/encounter-tracker/:id",children:r.a.createElement(G,{getData:this.getData,updateData:this.updateData})}),r.a.createElement(W.a,{path:"/"},r.a.createElement(M,{getData:this.getData,getAllDataByType:this.getAllDataByType,updateData:this.updateData,getAllData:this.getAllData,getStaticData:this.getStaticData,addData:this.addData,deleteData:this.deleteData,getDataStoreTypes:this.getDataStoreTypes,open:this.open})))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(H,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},48:function(e){e.exports=JSON.parse('[{"id":1,"name":"Drow","dndbeyond":"https://www.dndbeyond.com/monsters/drow"},{"id":2,"name":"Giant Spider","dndbeyond":"https://www.dndbeyond.com/monsters/giant-spider"}]')},75:function(e,a,t){e.exports=t(104)}},[[75,1,2]]]);
//# sourceMappingURL=main.40efb189.chunk.js.map